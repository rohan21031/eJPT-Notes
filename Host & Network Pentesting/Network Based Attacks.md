# Network-Based Attacks
##### These are the Attacks for networks, not OS

#### Network Services that could be vulnerable for attack:
• ARP
• DHCP
• SMB
• FTP
• Telnet
• SSH

##### Networks might experience more Man in the Middle (MITM) attacks 

##### Wireshark - is the tool that is mostly used for attacking networks and is used for capturing network traffic. 
# Tshark
- command line of wireshark
- `$ tshark -v`
- `$ tshark -h`
- `$ tshark -r HTTP_traffic.pcap`  -- check the .pcap file using tshark
- used for more target analysis, if looking for a specific thing
- `$ tshark -r HTTP_traffic.pcap -z io,phs -q`  -- for protocol hierarchy
- best for
	- batch analysis
	- offline processing
	- routine automation of traffic analysis task

#### Filtering Basics
- examples of filtering traffic
- `$ tshark -r HTTP_traffic.pcap -Y 'HTTP'`
- `$ tshark -r HTTP_traffic.pcap -Y 'ip.src==10.10.10.10 && ip.dst == 10.10.10.11'`
- `$ tshark -r HTTP_traffic.pcap -Y 'HTTP.request.method==GET'`
- `$ tshark -r HTTP_traffic.pcap -Y 'HTTP.request.method==GET' -Tfields -e frame.time -e ip.src -e http.request.full_uri`
- `$ tshark -r HTTP_traffic.pcap -Y 'HTTP contains password'`
# ARP Poisoning 
ARP poisoning is a type of attack that allows an attacker to intercept traffic between two hosts on a network. The attacker does this by sending spoofed ARP messages that associate their MAC address with the IP address of the target host. This causes the target host to send all of its traffic to the attacker, who can then read or modify it.
#### Tool Used: **Wireshark**

Wireshark is a network traffic analysis tool that can be used to capture and analyze ARP packets. This can be useful for detecting ARP poisoning attacks.
#### Commands used: 
- `$ echo 1 > /proc/sys/net/ipv4/ip_forward`

	- This command enables IP forwarding on the machine. IP forwarding is a feature that allows a machine to route traffic between different networks. This is necessary for ARP poisoning attacks, as the attacker needs to be able to send ARP messages to hosts on other networks.

- `$ arpspoof -i eth1 -t ip -r ip`

	- This command is used to launch an ARP poisoning attack. The `-i` option specifies the interface that the attacker is using, the `-t` option specifies the target IP address, and the `-r` option specifies the router IP address.
 - # WiFi Traffic Analysis
### We can use Wireshark to analyze the Wifi Traffic 
#### Filtering WiFi
- for filtering WiFi, we can use Tshark 
- `$ tshark -r file.pcap -Y 'wlan'`
